# 【What'sFun】 Oscilloscope Learning

1. 顶层模块 (top.v)
时钟管理: PLL生成100MHz系统时钟
寄存器组: 32个16位寄存器通过SPI配置
模块集成: 连接ADC、数据处理、显示、DAC各子系统
2. 数据采集链路
AD9288 → 滤波器 → 数据处理器

ad9288.v: 8位ADC接口,转换为无符号数(+127偏移)
filter.sv (Average_Filter): 8点滑动平均降噪
data_handler.v: 核心采集逻辑
降采样(1×至÷50000可调)
触发检测(上升/下降沿,自动/标准/单次模式)
双通道16KB RAM缓存
触发位置计算
显示握手控制
3. 测量与分析
freq_measure.v: 频率计
迟滞比较器触发
1秒闸门周期计数
输出频率值供显示
4. 控制接口
spi.sv (spi_slave): SPI从机

地址+数据协议
读写寄存器数组
按键状态上传
reg_decode.v: 寄存器译码

解析通道、触发、时基、垂直档位等参数
生成BCD码显示字符串
配置DAC、光标等功能
5. 显示子系统
LCD.v: ILI9488屏幕驱动(480×320)
8080并口时序
初始化序列
400×256波形区绘制
坐标轴、网格、触发标记
文本叠加(频率、档位、状态)
双通道彩色波形连线
6. 信号生成
DAC.v: 波形发生器
DDS内核(dds_ii)生成正弦/方波/三角/锯齿波
可调频率和8级衰减
10位DAC输出
三、关键数据流
1. 采集流程:
   模拟输入 → AD9288(100MSPS) → 滤波 → 降采样 → 触发判断 
   → RAM写入(16KB×2) → 触发位置记录

2. 显示流程:
   display_en触发 → RAM读取(以step为步进) → 波形插值连线 
   → 叠加网格/文本 → LCD刷新 → display_done

3. 控制流程:
   MCU SPI写入 → regs数组 → reg_decode解析 → 各模块配置
   (时基/触发电平/垂直档位/运行模式等)
   四、核心参数
采样率: 100MHz(可降采样至2.5kHz)
存储深度: 每通道16384点
垂直分辨率: 8位(256级)
显示窗口: 400点×256级波形区
触发模式: 自动/标准/单次,上升/下降沿
频率测量: 施密特触发+1秒闸门计数
五、模块间接口
ADC → data_handler: 8位数据+100MHz时钟
data_handler ↔ RAM: 写端口(采集)+读端口(显示)
data_handler → LCD: display_en握手+trig_pos触发点
SPI → regs → 各模块: 配置总线
reg_decode → LCD: 预格式化文本缓冲区

## LogicPi FPGA 数字示波器

- **目标**：基于 GW2A 器件实现双通道采集、LCD 可视化与 DDS 输出的教学示波平台。  
- **结构**：顶层 `top.v` 汇聚时钟、SPI 配置、采集链、显示与 DAC Five 个子系统。  
- **提示**：更多细节可在 `GW2A_test\src` 目录查看带注释的 Verilog 模块。